===================================================
SPEC: RES-PASO5-INVENTARIO
Modulo Inventario de Propiedades
Fecha: 2026-01-18
Por: C1 Sleepy
===================================================

OBJETIVO:
Lista de propiedades con distincion entre:
- Enlistadas (MLS/publicas)
- Pocket Listing (exclusivas/privadas)

===================================================
CREAR: app/components/InventarioTab.jsx
===================================================

```javascript
'use client'
import { useState, useEffect } from 'react'

const initialProperty = {
  id: '',
  // Basico
  titulo: '',
  tipo: 'casa',
  listingType: 'enlistada', // enlistada | pocket
  estatus: 'disponible',
  // Ubicacion
  zona: '',
  direccion: '',
  // Precio
  precio: '',
  moneda: 'USD',
  // Caracteristicas
  recamaras: '',
  banos: '',
  m2Construccion: '',
  m2Terreno: '',
  estacionamientos: '',
  // Extra
  amenidades: '',
  descripcion: '',
  fotoUrl: '',
  notas: '',
}

const Section = ({ title, isOpen, onToggle, children }) => (
  <div className="mb-3">
    <button
      type="button"
      onClick={onToggle}
      className="w-full flex justify-between items-center bg-white/10 px-4 py-2 rounded-xl text-white font-medium"
    >
      {title}
      <span>{isOpen ? 'â–¼' : 'â–¶'}</span>
    </button>
    {isOpen && (
      <div className="mt-2 space-y-3 px-2">
        {children}
      </div>
    )}
  </div>
)

const Input = ({ label, type = 'text', value, onChange, placeholder }) => (
  <div>
    <label className="block text-white/70 text-sm mb-1">{label}</label>
    <input
      type={type}
      value={value}
      onChange={onChange}
      placeholder={placeholder}
      className="w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/40 focus:outline-none focus:border-white/40"
    />
  </div>
)

const Select = ({ label, value, onChange, options }) => (
  <div>
    <label className="block text-white/70 text-sm mb-1">{label}</label>
    <select
      value={value}
      onChange={onChange}
      className="w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-white/40"
    >
      {options.map(opt => (
        <option key={opt.value} value={opt.value} className="bg-gray-800">
          {opt.label}
        </option>
      ))}
    </select>
  </div>
)

export default function InventarioTab({ t }) {
  const [properties, setProperties] = useState([])
  const [showForm, setShowForm] = useState(false)
  const [editingId, setEditingId] = useState(null)
  const [form, setForm] = useState(initialProperty)
  const [filter, setFilter] = useState('all') // all | enlistada | pocket
  const [sections, setSections] = useState({
    basico: true,
    ubicacion: false,
    precio: false,
    caracteristicas: false,
    extra: false,
  })

  useEffect(() => {
    const saved = localStorage.getItem('res_properties')
    if (saved) setProperties(JSON.parse(saved))
  }, [])

  const saveProperties = (newProps) => {
    setProperties(newProps)
    localStorage.setItem('res_properties', JSON.stringify(newProps))
  }

  const toggleSection = (key) => {
    setSections(prev => ({ ...prev, [key]: !prev[key] }))
  }

  const updateForm = (field, value) => {
    setForm(prev => ({ ...prev, [field]: value }))
  }

  const handleSave = () => {
    if (!form.titulo.trim()) return alert(t.titleRequired)
    
    if (editingId) {
      saveProperties(properties.map(p => p.id === editingId ? { ...form, id: editingId } : p))
    } else {
      const newProp = { ...form, id: Date.now().toString() }
      saveProperties([...properties, newProp])
    }
    setShowForm(false)
    setForm(initialProperty)
    setEditingId(null)
  }

  const handleEdit = (prop) => {
    setForm(prop)
    setEditingId(prop.id)
    setShowForm(true)
  }

  const handleDelete = (id) => {
    if (confirm(t.confirmDelete)) {
      saveProperties(properties.filter(p => p.id !== id))
    }
  }

  const filteredProps = filter === 'all' 
    ? properties 
    : properties.filter(p => p.listingType === filter)

  const formatPrice = (precio, moneda) => {
    if (!precio) return ''
    const num = parseFloat(precio).toLocaleString()
    return moneda === 'USD' ? `$${num} USD` : `$${num} MXN`
  }

  // Lista de propiedades
  if (!showForm) {
    return (
      <div>
        {/* Filtros */}
        <div className="flex gap-2 mb-4">
          {['all', 'enlistada', 'pocket'].map(f => (
            <button
              key={f}
              onClick={() => setFilter(f)}
              className={`px-3 py-1 rounded-full text-sm transition-all ${
                filter === f
                  ? 'bg-white/30 text-white'
                  : 'bg-white/10 text-white/60 hover:bg-white/20'
              }`}
            >
              {f === 'all' ? t.filterAll : f === 'enlistada' ? t.filterListed : t.filterPocket}
            </button>
          ))}
        </div>

        <div className="flex justify-between items-center mb-4">
          <span className="text-white/60">{filteredProps.length} {t.properties}</span>
          <button
            onClick={() => { setForm(initialProperty); setEditingId(null); setShowForm(true) }}
            className="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-xl text-white font-medium transition-all"
          >
            + {t.newProperty}
          </button>
        </div>
        
        {filteredProps.length === 0 ? (
          <p className="text-white/40 text-center py-8">{t.noProperties}</p>
        ) : (
          <div className="space-y-3">
            {filteredProps.map(prop => (
              <div
                key={prop.id}
                className="bg-white/10 rounded-xl p-4"
              >
                <div className="flex justify-between items-start">
                  <div className="flex-1">
                    <div className="flex items-center gap-2 mb-1">
                      <span className={`text-xs px-2 py-0.5 rounded-full ${
                        prop.listingType === 'pocket' 
                          ? 'bg-purple-500/30 text-purple-300' 
                          : 'bg-blue-500/30 text-blue-300'
                      }`}>
                        {prop.listingType === 'pocket' ? 'ğŸ”’ ' + t.pocket : 'ğŸ“‹ ' + t.listed}
                      </span>
                      <span className={`text-xs px-2 py-0.5 rounded-full ${
                        prop.estatus === 'disponible' ? 'bg-green-500/30 text-green-300' :
                        prop.estatus === 'apartada' ? 'bg-yellow-500/30 text-yellow-300' :
                        'bg-red-500/30 text-red-300'
                      }`}>
                        {t.status[prop.estatus]}
                      </span>
                    </div>
                    <p className="text-white font-medium">{prop.titulo}</p>
                    <p className="text-white/60 text-sm">{prop.zona}</p>
                    <p className="text-white/80 text-lg font-bold mt-1">
                      {formatPrice(prop.precio, prop.moneda)}
                    </p>
                    <p className="text-white/50 text-sm">
                      {prop.recamaras && `${prop.recamaras} ${t.beds}`}
                      {prop.banos && ` â€¢ ${prop.banos} ${t.baths}`}
                      {prop.m2Construccion && ` â€¢ ${prop.m2Construccion}mÂ²`}
                    </p>
                  </div>
                  <div className="flex flex-col gap-2">
                    <button
                      onClick={() => handleEdit(prop)}
                      className="text-white/60 hover:text-white px-2"
                    >
                      âœï¸
                    </button>
                    <button
                      onClick={() => handleDelete(prop.id)}
                      className="text-white/60 hover:text-red-400 px-2"
                    >
                      ğŸ—‘ï¸
                    </button>
                  </div>
                </div>
              </div>
            ))}
          </div>
        )}
      </div>
    )
  }

  // Formulario
  return (
    <div>
      <div className="flex justify-between items-center mb-4">
        <button
          onClick={() => { setShowForm(false); setForm(initialProperty); setEditingId(null) }}
          className="text-white/60 hover:text-white"
        >
          â† {t.back}
        </button>
        <h3 className="text-white font-medium">
          {editingId ? t.editProperty : t.newProperty}
        </h3>
        <button
          onClick={handleSave}
          className="bg-green-500/80 hover:bg-green-500 px-4 py-2 rounded-xl text-white font-medium transition-all"
        >
          {t.save}
        </button>
      </div>

      <div className="max-h-[60vh] overflow-y-auto pr-2">
        {/* BASICO */}
        <Section title={t.sections.basico} isOpen={sections.basico} onToggle={() => toggleSection('basico')}>
          <Input label={t.fields.titulo + ' *'} value={form.titulo} onChange={e => updateForm('titulo', e.target.value)} placeholder="Ej: Casa en Marina Vallarta" />
          <Select
            label={t.fields.tipo}
            value={form.tipo}
            onChange={e => updateForm('tipo', e.target.value)}
            options={[
              { value: 'casa', label: t.types.casa },
              { value: 'depto', label: t.types.depto },
              { value: 'terreno', label: t.types.terreno },
              { value: 'local', label: t.types.local },
              { value: 'bodega', label: t.types.bodega },
            ]}
          />
          <Select
            label={t.fields.listingType}
            value={form.listingType}
            onChange={e => updateForm('listingType', e.target.value)}
            options={[
              { value: 'enlistada', label: 'ğŸ“‹ ' + t.listed },
              { value: 'pocket', label: 'ğŸ”’ ' + t.pocket },
            ]}
          />
          <Select
            label={t.fields.estatus}
            value={form.estatus}
            onChange={e => updateForm('estatus', e.target.value)}
            options={[
              { value: 'disponible', label: t.status.disponible },
              { value: 'apartada', label: t.status.apartada },
              { value: 'vendida', label: t.status.vendida },
            ]}
          />
        </Section>

        {/* UBICACION */}
        <Section title={t.sections.ubicacion} isOpen={sections.ubicacion} onToggle={() => toggleSection('ubicacion')}>
          <Input label={t.fields.zona} value={form.zona} onChange={e => updateForm('zona', e.target.value)} placeholder="Ej: Marina Vallarta, Zona RomÃ¡ntica" />
          <Input label={t.fields.direccion} value={form.direccion} onChange={e => updateForm('direccion', e.target.value)} />
        </Section>

        {/* PRECIO */}
        <Section title={t.sections.precio} isOpen={sections.precio} onToggle={() => toggleSection('precio')}>
          <div className="flex gap-2">
            <div className="flex-1">
              <Input label={t.fields.precio} type="number" value={form.precio} onChange={e => updateForm('precio', e.target.value)} />
            </div>
            <div className="w-24">
              <Select
                label=" "
                value={form.moneda}
                onChange={e => updateForm('moneda', e.target.value)}
                options={[
                  { value: 'USD', label: 'ğŸ‡ºğŸ‡¸ USD' },
                  { value: 'MXN', label: 'ğŸ‡²ğŸ‡½ MXN' },
                ]}
              />
            </div>
          </div>
        </Section>

        {/* CARACTERISTICAS */}
        <Section title={t.sections.caracteristicas} isOpen={sections.caracteristicas} onToggle={() => toggleSection('caracteristicas')}>
          <div className="grid grid-cols-2 gap-3">
            <Input label={t.fields.recamaras} type="number" value={form.recamaras} onChange={e => updateForm('recamaras', e.target.value)} />
            <Input label={t.fields.banos} type="number" value={form.banos} onChange={e => updateForm('banos', e.target.value)} />
            <Input label={t.fields.m2Construccion} type="number" value={form.m2Construccion} onChange={e => updateForm('m2Construccion', e.target.value)} />
            <Input label={t.fields.m2Terreno} type="number" value={form.m2Terreno} onChange={e => updateForm('m2Terreno', e.target.value)} />
          </div>
          <Input label={t.fields.estacionamientos} type="number" value={form.estacionamientos} onChange={e => updateForm('estacionamientos', e.target.value)} />
          <Input label={t.fields.amenidades} value={form.amenidades} onChange={e => updateForm('amenidades', e.target.value)} placeholder="Ej: Alberca, Gym, Seguridad 24h" />
        </Section>

        {/* EXTRA */}
        <Section title={t.sections.extra} isOpen={sections.extra} onToggle={() => toggleSection('extra')}>
          <Input label={t.fields.fotoUrl} value={form.fotoUrl} onChange={e => updateForm('fotoUrl', e.target.value)} placeholder="https://..." />
          <div>
            <label className="block text-white/70 text-sm mb-1">{t.fields.descripcion}</label>
            <textarea
              value={form.descripcion}
              onChange={e => updateForm('descripcion', e.target.value)}
              rows={3}
              className="w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/40 focus:outline-none focus:border-white/40 resize-none"
            />
          </div>
          <div>
            <label className="block text-white/70 text-sm mb-1">{t.fields.notas}</label>
            <textarea
              value={form.notas}
              onChange={e => updateForm('notas', e.target.value)}
              rows={2}
              className="w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/40 focus:outline-none focus:border-white/40 resize-none"
              placeholder={t.notasPlaceholder}
            />
          </div>
        </Section>
      </div>
    </div>
  )
}
```

===================================================
AGREGAR TRADUCCIONES en app/page.js
===================================================

En translations.es agregar:

```javascript
inventario: {
  properties: 'propiedades',
  newProperty: 'Nueva Propiedad',
  editProperty: 'Editar Propiedad',
  noProperties: 'No hay propiedades registradas',
  back: 'Volver',
  save: 'Guardar',
  titleRequired: 'El tÃ­tulo es requerido',
  confirmDelete: 'Â¿Eliminar esta propiedad?',
  filterAll: 'Todas',
  filterListed: 'Enlistadas',
  filterPocket: 'Pocket',
  listed: 'Enlistada',
  pocket: 'Pocket Listing',
  beds: 'rec',
  baths: 'baÃ±os',
  sections: {
    basico: 'ğŸ  InformaciÃ³n BÃ¡sica',
    ubicacion: 'ğŸ“ UbicaciÃ³n',
    precio: 'ğŸ’° Precio',
    caracteristicas: 'ğŸ“ CaracterÃ­sticas',
    extra: 'ğŸ“ Adicional',
  },
  fields: {
    titulo: 'TÃ­tulo',
    tipo: 'Tipo de Propiedad',
    listingType: 'Tipo de Listing',
    estatus: 'Estatus',
    zona: 'Zona',
    direccion: 'DirecciÃ³n',
    precio: 'Precio',
    recamaras: 'RecÃ¡maras',
    banos: 'BaÃ±os',
    m2Construccion: 'mÂ² ConstrucciÃ³n',
    m2Terreno: 'mÂ² Terreno',
    estacionamientos: 'Estacionamientos',
    amenidades: 'Amenidades',
    fotoUrl: 'URL de Foto',
    descripcion: 'DescripciÃ³n',
    notas: 'Notas Privadas',
  },
  types: {
    casa: 'Casa',
    depto: 'Departamento',
    terreno: 'Terreno',
    local: 'Local Comercial',
    bodega: 'Bodega',
  },
  status: {
    disponible: 'ğŸŸ¢ Disponible',
    apartada: 'ğŸŸ¡ Apartada',
    vendida: 'ğŸ”´ Vendida',
  },
  notasPlaceholder: 'Notas internas (no visibles al cliente)',
},
```

En translations.en agregar:

```javascript
inventario: {
  properties: 'properties',
  newProperty: 'New Property',
  editProperty: 'Edit Property',
  noProperties: 'No properties registered',
  back: 'Back',
  save: 'Save',
  titleRequired: 'Title is required',
  confirmDelete: 'Delete this property?',
  filterAll: 'All',
  filterListed: 'Listed',
  filterPocket: 'Pocket',
  listed: 'Listed',
  pocket: 'Pocket Listing',
  beds: 'bed',
  baths: 'bath',
  sections: {
    basico: 'ğŸ  Basic Info',
    ubicacion: 'ğŸ“ Location',
    precio: 'ğŸ’° Price',
    caracteristicas: 'ğŸ“ Features',
    extra: 'ğŸ“ Additional',
  },
  fields: {
    titulo: 'Title',
    tipo: 'Property Type',
    listingType: 'Listing Type',
    estatus: 'Status',
    zona: 'Area',
    direccion: 'Address',
    precio: 'Price',
    recamaras: 'Bedrooms',
    banos: 'Bathrooms',
    m2Construccion: 'Construction sqft',
    m2Terreno: 'Land sqft',
    estacionamientos: 'Parking',
    amenidades: 'Amenities',
    fotoUrl: 'Photo URL',
    descripcion: 'Description',
    notas: 'Private Notes',
  },
  types: {
    casa: 'House',
    depto: 'Condo',
    terreno: 'Land',
    local: 'Commercial',
    bodega: 'Warehouse',
  },
  status: {
    disponible: 'ğŸŸ¢ Available',
    apartada: 'ğŸŸ¡ Reserved',
    vendida: 'ğŸ”´ Sold',
  },
  notasPlaceholder: 'Internal notes (not visible to client)',
},
```

===================================================
MODIFICAR: app/page.js - Agregar import y uso
===================================================

1. Agregar import:
```javascript
import InventarioTab from './components/InventarioTab'
```

2. En el area de contenido:
```javascript
{activeTab === 'clientes' && <ClientesTab t={t.clientes} />}
{activeTab === 'inventario' && <InventarioTab t={t.inventario} />}
{(activeTab === 'comps' || activeTab === 'match') && (
  <p className="text-white/60 text-center">
    {t.tabs[activeTab]} - {t.soon}
  </p>
)}
```

===================================================
DIFERENCIA ENLISTADA vs POCKET
===================================================

ENLISTADA (ğŸ“‹):
- Propiedad publica en MLS
- Se puede compartir abiertamente
- Badge azul

POCKET LISTING (ğŸ”’):
- Propiedad exclusiva/privada
- Solo para clientes selectos
- No esta en MLS
- Badge morado
- Filtro separado

===================================================
CRITERIO DE EXITO
===================================================

[ ] Tab Inventario muestra lista con filtros
[ ] Filtros: Todas | Enlistadas | Pocket
[ ] Cards muestran badge de tipo (enlistada/pocket)
[ ] Cards muestran estatus con color
[ ] CRUD completo funciona
[ ] localStorage persiste datos
[ ] Bilingue ES/EN

===================================================
COMMIT
===================================================

"feat: add Inventario module with Listed/Pocket distinction"

===================================================
FIN RES-PASO5-INVENTARIO
===================================================
